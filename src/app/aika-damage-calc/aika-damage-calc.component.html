<div class="root">
    <div class="damage-rate-calc">
        <div class="title">攻擊傷害比率計算 要打訓練場的靶子來計算</div>
        <table>
            <thead>
                <tr>
                    <th class="name">名稱</th>
                    <th class="atk">ATK</th>
                    <th class="attr">屬性</th>
                    <th class="min-dmg">最小傷害</th>
                    <th class="max-dmg">最大傷害</th>
                    <th class="addon-calc">附加計算</th>
                    <th class="output-dmg-rate">傷害比率</th>
                    <!-- <th class="close"></th> -->
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let item of dmgrList">
                    <td class="name">
                        <input type="text" [(ngModel)]="item.name" (ngModelChange)="item.update()">
                    </td>
                    <td class="atk">
                        <input type="number" [(ngModel)]="item.atk" (ngModelChange)="item.update()">
                    </td>
                    <td class="attr">
                        <input type="number" [(ngModel)]="item.attr" (ngModelChange)="item.update()">
                    </td>
                    <td class="min-dmg">
                        <input type="number" [(ngModel)]="item.minDmg" (ngModelChange)="item.update()">
                    </td>
                    <td class="max-dmg">
                        <input type="number" [(ngModel)]="item.maxDmg" (ngModelChange)="item.update()">
                    </td>
                    <td class="addon-calc">
                        <div class="addon" *ngFor="let extraItem of item.extraCalc">
                            <select [(ngModel)]="extraItem.type" (ngModelChange)="item.update()">
                                <option value="+" selected>+</option>
                                <option value="-">-</option>
                                <option value="×">×</option>
                                <option value="÷">÷</option>
                            </select>
                            <input type="number" [(ngModel)]="extraItem.value" (ngModelChange)="item.update()">
                            <button class="delete" (click)="item.deleteExtraCalc(extraItem);item.update()">X</button>
                        </div>
                        <button class="add" (click)="item.addExtraCalc()">[+]</button>
                    </td>
                    <td class="output-dmg-rate">{{(item.damageRate*100)}}%</td>
                    <td class="close">
                        <div class="wrapper">
                            <button class="delete" (click)="removeRate(item)">X</button>
                        </div>
                    </td>
                </tr>
                <tr class="add-row">
                    <td colspan="7">
                        <button class="add" (click)="addRate()">[+]</button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    <!-- <div class="enemy-def-calc">
        <div class="title">敵人DEF計算</div>
        <table>
            <thead>
                <tr>
                    <th class="name">名稱</th>
                    <th class="attack-atk phy">ATK</th>
                    <th class="attack-attr ene">屬性</th>
                    <th class="attack-rate">傷害比率</th>
                    <th class="enemy-attr ene">敵人屬性</th>
                    <th class="enemy-resist phy">敵人耐性</th>
                    <th class="enemy-def phy">敵人DEF</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td></td>
                </tr>
            </tbody>
        </table>
    </div> -->
    <!-- <div class="debuff-calc">
        <div class="title">DEBUFF計算</div>
        <table>
            <thead>
                <tr>
                    <th class="name">名稱</th>
                    <th class="attack-atk phy">ATK</th>
                    <th class="attack-attr ene">屬性</th>
                    <th class="attack-rate">傷害比率</th>
                    <th class="enemy-attr ene">敵人屬性</th>
                    <th class="enemy-resist phy">敵人耐性</th>
                    <th class="enemy-def phy">敵人DEF</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td></td>
                </tr>
            </tbody>
        </table>
    </div> -->
    <div class="damage-calc">
        <div class="title">輸出傷害計算</div>
        <table>
            <thead>
                <tr>
                    <th class="name">名稱</th>
                    <th class="atk phy" [title]="help.atk">ATK</th>
                    <th class="attr ene" [title]="help.attr">屬性</th>
                    <th class="dmg-rate" [title]="help.dmgRate">傷害比率</th>
                    <th class="final-dmg-buff" [title]="help.finalDmgBuff">最終傷害<br>加成</th>
                    <th class="enemy-def phy" [title]="help.enemyDef">敵人DEF</th>
                    <th class="enemy-attr ene">敵人屬性</th>
                    <th class="enemy-resist phy">敵人耐性</th>
                    <th class="enemy-debuff ene" [title]="help.enemyDebuff">敵人debuff</th>
                    <th class="calc-dmg-atk phy">物理傷害</th>
                    <th class="calc-dmg-attr ene">屬性傷害</th>
                    <th class="output-dmg">輸出傷害<br>最低~理論~最高</th>
                    <!-- <th></th> -->
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let item of dmgcList">
                    <td class="name">
                        <input type="text" [(ngModel)]="item.name" (ngModelChange)="item.update()">
                    </td>
                    <td class="attack-atk phy">
                        <div class="wrapper">
                            <select [(ngModel)]="item.atkTypeId" (ngModelChange)="item.update()">
                                <option value="1">打擊</option>
                                <option value="2">斬擊</option>
                                <option value="3">實彈</option>
                                <option value="4">能量</option>
                            </select>
                            <input type="number" [(ngModel)]="item.atk" (ngModelChange)="item.update()">
                        </div>
                    </td>
                    <td class="attack-attr ene">
                        <div class="wrapper">
                            <select [(ngModel)]="item.attrTypeId" (ngModelChange)="item.update()">
                                <option value="5">電擊</option>
                                <option value="6">重力</option>
                                <option value="7">燒夷</option>
                                <option value="8">冷擊</option>
                            </select>
                            <input type="number" [(ngModel)]="item.attr" (ngModelChange)="item.update()">
                        </div>
                    </td>
                    <td class="attack-rate">
                        <input type="number" [(ngModel)]="item.damageRatePercent" (ngModelChange)="item.update()">%
                    </td>
                    <td class="final-dmg-buff">
                        <input type="number" [(ngModel)]="item.finalDamageBuff" (ngModelChange)="item.update()">%
                    </td>
                    <td class="enemy-def phy">
                        <input type="number" [(ngModel)]="item.enemyDef" (ngModelChange)="item.update()">
                    </td>
                    <td class="enemy-attr ene">
                        <select [(ngModel)]="item.enemyAttrTypeId" (ngModelChange)="item.update()">
                            <option value="22">無</option>
                            <option value="5">電擊</option>
                            <option value="6">重力</option>
                            <option value="7">燒夷</option>
                            <option value="8">冷擊</option>
                        </select>
                    </td>
                    <td class="enemy-resist phy">
                        <select [(ngModel)]="item.enemyResist" (ngModelChange)="item.update()">
                            <option value="22">無</option>
                            <option value="1">打擊</option>
                            <option value="2">斬擊</option>
                            <option value="3">實彈</option>
                            <option value="4">能量</option>
                        </select>
                    </td>
                    <td class="enemy-debuff ene">
                        <div class="wrapper" *ngFor="let item2 of item.enemyDebuff">
                            <select [(ngModel)]="item2.attrTypeId" (ngModelChange)="item.update()">
                                <option value="5">電擊</option>
                                <option value="6">重力</option>
                                <option value="7">燒夷</option>
                                <option value="8">冷擊</option>
                            </select>
                            <input type="number" [(ngModel)]="item2.value" (ngModelChange)="item.update()">%
                            <button class="delete" (click)="item.deleteEnemyDebuff(item2);item.update()">X</button>
                        </div>
                        <button class="add" (click)="item.addEnemyDebuff()">[+]</button>
                    </td>
                    <td class="calc-dmg-atk phy">{{item.outputAtkDamage}}</td>
                    <td class="calc-dmg-attr ene">{{item.outputAttrDamage}}</td>
                    <td class="output-dmg">{{item.outputDamageMin}}~{{item.outputDamage}}~{{item.outputDamageMax}}</td>
                    <td class="close">
                        <div class="wrapper">
                            <button class="delete" (click)="removeCalc(item)">X</button>
                        </div>
                    </td>
                </tr>
                <tr class="add-row">
                    <td colspan="12">
                        <button class="add" (click)="addCalc()">[+]</button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>